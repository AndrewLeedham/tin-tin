(this["webpackJsonptin-tin"]=this["webpackJsonptin-tin"]||[]).push([[0],{104:function(e,t,n){e.exports=n(142)},142:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),c=n(62),l=n.n(c),o=n(51),i=n(158),u=n(42),s=n(155),m=Object(u.a)({},s.a,{colors:Object(u.a)({},s.a.colors,{brand:{50:"#ffe2e7",100:"#ffb3bb",200:"#fc8393",300:"#f9526d",400:"#f6224b",500:"#dd0939",600:"#ad0320",700:"#7c000e",800:"#4d0002",900:"#200400"}})}),d=n(67),f=n(53),b=n(9),E=n(34),h=n(30),g=n.n(h),v=n(92),p=0,O=1,j=2;function S(e){var t=window.localStorage.getItem("user");if(t)try{var n=JSON.parse(t);if(e&&n.sessionId!==e)return;return n}catch(a){return void console.warn("Could not read user from local session: ",a)}}function w(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n={sessionId:e,admin:t,state:p,names:void 0};return window.localStorage.setItem("user",JSON.stringify(n)),n}function y(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=Object(a.useState)((function(){return e&&S(e)||w(e,!e)})),n=Object(b.a)(t,2),r=n[0],c=n[1];function l(e){window.localStorage.setItem("user",JSON.stringify(e)),c(e)}return[r,l]}var C=n(70),I=n(150),k=n(102),x=n(82),z=n(6),D=n(148),N=n(149);function F(e){var t=e.heading,n=e.subHeading,a=e.children;return r.a.createElement(z.a,{position:"relative",my:"10",maxW:"md",mx:"auto",px:"4"},t&&r.a.createElement(D.a,{as:"h1",mb:2},t),n&&r.a.createElement(N.a,{fontSize:"xl",mb:5},n),a)}var V=n(79);function W(e){var t=e.children;return r.a.createElement("div",{style:{content:"",display:"table",clear:"both"}},t)}function R(e){var t=e.count,n=e.onSubmit,c=Object(a.useState)(new Array(t).fill("")),l=Object(b.a)(c,2),o=l[0],i=l[1];return r.a.createElement(F,{heading:"Submit your names",subHeading:"Enter the ".concat(t,' names you want to put in the tin, then press "Submit names".')},r.a.createElement("form",{onSubmit:function(e){e.preventDefault(),n(o)}},o.map((function(e,t){return r.a.createElement(C.a,{key:t,isRequired:!0,mb:4},r.a.createElement(I.a,{htmlFor:"name-".concat(t)},"Name ",t+1),r.a.createElement(k.a,{id:"name-".concat(t),value:e,onChange:function(e){return function(e,t){var n=Object(E.a)(o);n[e]=t,i(n)}(t,e.target.value)},mb:2,minLength:1,maxLength:30}))})),r.a.createElement(x.a,{type:"submit",variant:"solid",variantColor:"green",rightIcon:V.a,float:"right"},"Submit names"),r.a.createElement(x.a,{variant:"outline",rightIcon:V.b,float:"left",onClick:function(){return n([])}},"Skip and join")),r.a.createElement(W,null))}var A=n(65),P=n(95),T=n(151),J=n(154),M=n(20);function H(e){var t=e.startTurn,n=e.round,c=e.noNames,l=e.timer,o=e.lock,i=Object(a.useState)(l?Math.floor(l/60):1),u=Object(b.a)(i,2),s=u[0],m=u[1],d=Object(a.useState)(l?Math.floor(l%60):0),f=Object(b.a)(d,2),E=f[0],h=f[1],g=Object(a.useRef)(null),v=Object(a.useRef)(null);return r.a.createElement(F,{heading:"Tin-tin",subHeading:'Welcome to tin-tin, press "Start turn" when it is your go. "Start round" will be shown if there are no names left.'},r.a.createElement("form",{onSubmit:function(e){e.preventDefault(),t(s,E)}},r.a.createElement(T.a,{isInline:!0,spacing:4,mb:4},r.a.createElement(C.a,null,r.a.createElement(I.a,{htmlFor:"minutes"},"Minutes"),r.a.createElement(J.c,{id:"minutes",defaultValue:s,min:0,max:5,isInvalid:0===s&&0===E,ref:v,onChange:function(e){var t=v.current.children[0],n=g.current.children[0];0===e&&0===E?(t.setCustomValidity("Either minutes or seconds must be over 0"),t.reportValidity()):(t.setCustomValidity(""),n.setCustomValidity("")),m(e)}},r.a.createElement(J.d,null),r.a.createElement(J.e,null,r.a.createElement(J.b,null),r.a.createElement(J.a,null)))),r.a.createElement(C.a,null,r.a.createElement(I.a,{htmlFor:"seconds"},"Seconds"),r.a.createElement(J.c,{id:"seconds",defaultValue:E,min:0,max:60,isInvalid:0===s&&0===E,ref:g,onChange:function(e){var t=v.current.children[0],n=g.current.children[0];0===e&&0===s?(n.setCustomValidity("Either minutes or seconds must be over 0"),n.reportValidity()):(t.setCustomValidity(""),n.setCustomValidity("")),h(e)}},r.a.createElement(J.d,null),r.a.createElement(J.e,null,r.a.createElement(J.b,null),r.a.createElement(J.a,null))))),r.a.createElement(T.a,{isInline:!0,justify:"center"},r.a.createElement(x.a,{type:"submit",variant:"solid",variantColor:"green",rightIcon:M.g,isDisabled:c||o},"Start ",n?"round":"turn"))),r.a.createElement(W,null))}var B=n(152),L=n(153),q=n(49),U=n(156),_=n(75),G=n(97),Y=n(103);function K(e){var t=e.toString();return 1===t.length?"0"+t:t}function Q(e){var t=e.time,n=e.reset,c=e.toggle,l=e.isPaused,o=Object(Y.a)(e,["time","reset","toggle","isPaused"]),i=Object(a.useState)(!1),u=Object(b.a)(i,2),s=u[0],m=u[1];return r.a.createElement(A.a,Object.assign({rounded:"md",borderWidth:1,borderColor:"black",px:1,alignItems:"center"},o),r.a.createElement(B.a,{size:"sm","aria-label":"Hide timer",icon:s?M.b:M.c,variant:"ghost",onClick:function(){return m(!s)}}),r.a.createElement(N.a,{as:"span",fontSize:"md",style:{fontVariantNumeric:"tabular-nums"},opacity:s?0:1,mx:2},K(Math.floor(t/60)),":",K(Math.floor(t%60))),r.a.createElement(B.a,{size:"sm","aria-label":l?"Resume timer":"Pause timer",icon:l?M.g:M.f,variant:"ghost",onClick:function(){return c()}}),r.a.createElement(B.a,{size:"sm","aria-label":"Reset timer",icon:M.i,variant:"ghost",onClick:function(){return n()}}))}function X(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=Object(a.useState)((function(){var n=window.localStorage.getItem(e);if(null!==n)try{return JSON.parse(n)}catch(a){}return t})),r=Object(b.a)(n,2),c=r[0],l=r[1];function o(t){window.localStorage.setItem(e,JSON.stringify(t)),l(t)}function i(){window.localStorage.removeItem(e)}return[c,o,i]}function $(e){var t=e.names,n=e.endTurn,c=e.timer,l=X("names",t),o=Object(b.a)(l,3),i=o[0],u=o[1],s=o[2],m=X("currentTile",0),d=Object(b.a)(m,3),f=d[0],h=d[1],g=d[2],v=X("passed",null),p=Object(b.a)(v,3),O=p[0],j=p[1],S=p[2],w=X("isOpen",!1),y=Object(b.a)(w,3),C=y[0],I=y[1],k=y[2],D=X("isCancelable",!0),V=Object(b.a)(D,3),R=V[0],P=V[1],J=V[2],H=function(e,t){var n=Object(a.useState)(!1),r=Object(b.a)(n,2),c=r[0],l=r[1],o=X("time",e),i=Object(b.a)(o,3),u=i[0],s=i[1],m=i[2],d=Object(a.useState)(Date.now()),f=Object(b.a)(d,2),E=f[0],h=f[1],g=Object(a.useState)((function(){var e=new Audio("".concat(".","/alarm.mp3"));return e.loop=!0,e})),v=Object(b.a)(g,1)[0];return Object(a.useEffect)((function(){var e=setInterval((function(){if(!0!==c){var e=Date.now();e-E>=1e3?u-1>0?s(u-1):(s(0),l(!0),v.play(),t&&t()):h(e)}}),1e3);return function(){return clearInterval(e)}})),[u,c,l,function(){s(e),h(Date.now()),v.pause()},function(){m(),v.pause()}]}(c,(function(){P(!1),I(!0)})),Y=Object(b.a)(H,5),K=Y[0],$=Y[1],Z=Y[2],ee=Y[3],te=Y[4],ne=function(){Z(!1),I(!1)};var ae=r.a.useRef();function re(e,t){var n=Object(E.a)(i);n[e].answered=!!t,u(n)}var ce=null!==f||null!==O?"".concat((null!==f&&void 0!==f?f:O)+1,"/").concat(i.length):"";return r.a.createElement(r.a.Fragment,null,r.a.createElement(F,{heading:"Tin-tin ".concat(ce)},null!==f||null!==O?r.a.createElement(_.a,{onSwipe:function(e){var t=!1;e===_.b.LEFT?null!==O?(re(O,!0),j(null),t=!0):j(f):e===_.b.RIGHT&&re(f,!0),t||(f+1<i.length?h(f+1):h(null))},renderButtons:function(e){var t=e.left,n=e.right;return r.a.createElement(T.a,{isInline:!0,flex:"1",justifyContent:"space-between",spacing:2,p:8},r.a.createElement(B.a,{size:"lg","aria-label":null===O?"Pass":"Answered passed",icon:null===O?M.j:M.a,variant:"solid",variantColor:null===O?"red":"orange",onClick:t}),null!==O&&null!==f&&r.a.createElement(N.a,null,r.a.createElement("strong",null,"Passed:")," ",i[O].name),r.a.createElement(B.a,{size:"lg","aria-label":null!==f?"Correct":"Answered passed",icon:M.a,variantColor:null!==f?"green":"orange",onClick:null!==f?n:t}))}},r.a.createElement(z.a,{rounded:"lg",borderWidth:1,py:"6rem",px:2,textAlign:"center"},r.a.createElement(N.a,{fontSize:"3xl",className:G.noselect},null!==f?i[f].name:"Passed: ".concat(i[O].name)))):r.a.createElement(z.a,{py:"6rem",px:2,textAlign:"center"},r.a.createElement(N.a,{fontSize:"3xl",color:"grey.200"},"No more names!")),r.a.createElement(A.a,{justifyContent:"space-between",mt:10},r.a.createElement(Q,{time:K,reset:ee,initialTime:c,isPaused:$,toggle:function(){return Z(!$)}}),r.a.createElement(x.a,{variant:"outline",variantColor:"red",rightIcon:M.f,onClick:function(){Z(!0),I(!0)}},"End turn")),r.a.createElement(W,null)),r.a.createElement(L.a,{isOpen:C,leastDestructiveRef:R&&ae,onClose:R&&ne,closeOnOverlayClick:R,closeOnEsc:R},r.a.createElement(q.f,null),r.a.createElement(L.b,null,r.a.createElement(q.e,{fontSize:"lg",fontWeight:"bold"},"Double check you did not mis-click anything:"),r.a.createElement(q.b,null,i.slice(0,null!==f?f+1:i.length).map((function(e,t){var n=e.name,a=e.answered;return r.a.createElement(U.a,{id:"name-".concat(t),isChecked:a,onChange:function(e){return re(t,e.target.checked)},isInline:!0,isFullWidth:!0,key:t,rounded:"md",borderWidth:1,p:2,mb:2},n)})),r.a.createElement(N.a,null,"You scored",": "+i.reduce((function(e,t){var n=t.answered;return e+Number(n)}),0))),r.a.createElement(q.d,null,R&&r.a.createElement(x.a,{ref:ae,onClick:ne},"Cancel"),r.a.createElement(x.a,{variantColor:"green",onClick:function(){s(),g(),S(),k(),J(),te(),n(i)},ml:3},"Confirm")))))}var Z=n(157);function ee(e){var t=e.error;return r.a.createElement(Z.a,{status:"error",variant:"subtle",flexDirection:"column",justifyContent:"center",textAlign:"center",height:"200px"},r.a.createElement(Z.c,{size:"40px",mr:0}),r.a.createElement(Z.d,{mt:4,mb:1,fontSize:"lg"},"Something went wrong"),r.a.createElement(Z.b,{maxWidth:"sm"},t.toString()))}function te(){var e=r.a.useState(),t=Object(b.a)(e,2)[1];return r.a.useCallback((function(e){t((function(){throw e}))}),[t])}function ne(e,t,n,a,r){return function(c){var l=e.carbon?Object.values(e.carbon):[];g.a.database().ref("sessions/".concat(t,"/carbon")).set([].concat(Object(E.a)(l),Object(E.a)(c))).catch(r),a(Object(u.a)({},n,{state:j}))}}function ae(e){for(var t=e.length-1;t>0;t--){var n=Math.floor(Math.random()*(t+1)),a=[e[n],e[t]];e[t]=a[0],e[n]=a[1]}return e}function re(e,t,n,a,r){return function(c,l){g.a.database().ref("sessions/".concat(t,"/lock")).set(!0).catch(r);var o=e.current?Object.values(e.current):Object.values(e.carbon);e.current||g.a.database().ref("sessions/".concat(t,"/current")).set(Object(E.a)(o)).catch(r),a(Object(u.a)({},n,{names:ae(o).map((function(e){return{name:e,answered:!1}})),state:O,timer:60*c+l}))}}function ce(e,t,n,a){return function(r){r=r.filter((function(e){return!e.answered})).map((function(e){return e.name})),g.a.database().ref("sessions/".concat(e,"/current")).set(Object(E.a)(r)).catch(a),g.a.database().ref("sessions/".concat(e,"/lock")).set(!1),n(Object(u.a)({},t,{names:void 0,state:j}))}}function le(){var e=Object(f.g)().id,t=te(),n=Object(v.a)(g.a.database().ref("sessions/".concat(e))),a=Object(b.a)(n,3),c=a[0],l=a[1],o=a[2],i=y(e),u=Object(b.a)(i,2),s=u[0],m=u[1];return r.a.createElement(r.a.Fragment,null,l&&!o&&r.a.createElement(A.a,{alignItems:"center",justifyContent:"center",mt:16},r.a.createElement(P.a,{size:"xl",transform:"translate(-50%, -50%)"})),o&&!l&&r.a.createElement(F,null,r.a.createElement(ee,{error:o.toString()})),!l&&!o&&function(e,t,n,a,c){switch(n.state){case p:return r.a.createElement(R,{count:e.count,onSubmit:ne(e,t,n,a,c)});case j:return r.a.createElement(H,{startTurn:re(e,t,n,a,c),round:!e.current||0===Object.values(e.current).length,noNames:!e.carbon||0===Object.values(e.carbon).length,timer:n.timer,lock:!!e.lock});case O:return r.a.createElement($,{names:n.names,timer:n.timer,endTurn:ce(t,n,a,c)});default:return"Unknown state: ".concat(n.state)}}(c.val(),e,s,m,t))}var oe=n(101);function ie(){var e=Object(a.useState)(""),t=Object(b.a)(e,2),n=t[0],c=t[1],l=Object(a.useState)(""),o=Object(b.a)(l,2),i=o[0],s=o[1],m=Object(oe.a)(g.a.auth()),d=Object(b.a)(m,3),E=d[0],h=d[1],v=d[2],p=Object(a.useState)(void 0),O=Object(b.a)(p,2),j=O[0],S=O[1],w=Object(a.useState)(4),z=Object(b.a)(w,2),D=z[0],N=z[1],V=Object(a.useState)(void 0),R=Object(b.a)(V,2),A=R[0],T=R[1],H=y(),B=Object(b.a)(H,2),L=B[0],q=B[1],U=te();return Object(a.useEffect)((function(){L.sessionId&&T(L.sessionId)}),[L.sessionId]),r.a.createElement(r.a.Fragment,null,h&&!v&&r.a.createElement(P.a,{size:"xl",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"}),!h&&v&&r.a.createElement(F,null,r.a.createElement(ee,{error:v.toString()})),!h&&!v&&E&&(A?r.a.createElement(f.a,{to:"/sessions/".concat(A)}):r.a.createElement(F,{heading:"Create a new session",subHeading:"Start a new tin-tin game session with the number of names per player you want. You will be redirected to a shareable url that other players can join from."},r.a.createElement("form",{onSubmit:function(e){e.preventDefault(),g.a.database().ref("sessions").push({count:D,timestamp:Date.now()}).then((function(e){var t=e.key;q(Object(u.a)({},L,{sessionId:t}))})).catch(U)}},r.a.createElement(C.a,null,r.a.createElement(I.a,{htmlFor:"count"},"Number of names a player can select"),r.a.createElement(J.c,{id:"count",defaultValue:D,min:1,max:10,onChange:N,mb:4},r.a.createElement(J.d,null),r.a.createElement(J.e,null,r.a.createElement(J.b,null),r.a.createElement(J.a,null)))),r.a.createElement(x.a,{variant:"outline",rightIcon:M.e,float:"left",onClick:function(){g.a.auth().signOut().catch(S)}},"Logout"),r.a.createElement(x.a,{type:"submit",variant:"solid",variantColor:"green",rightIcon:M.h,float:"right"},"Create new session")),r.a.createElement(W,null))),!E&&!h&&!v&&r.a.createElement(F,null,j&&r.a.createElement(ee,{error:j}),r.a.createElement("form",{onSubmit:function(e){e.preventDefault(),S(void 0),g.a.auth().signInWithEmailAndPassword(n,i).catch(S)}},r.a.createElement(C.a,{isRequired:!0,mb:4},r.a.createElement(I.a,{htmlFor:"username"},"Username"),r.a.createElement(k.a,{type:"email",id:"username",value:n,onChange:function(e){return c(e.target.value)},mb:2})),r.a.createElement(C.a,{isRequired:!0,mb:4},r.a.createElement(I.a,{htmlFor:"password"},"Password"),r.a.createElement(k.a,{type:"password",id:"password",value:i,onChange:function(e){return s(e.target.value)},mb:2})),r.a.createElement(x.a,{type:"submit",variant:"solid",variantColor:"green",rightIcon:M.d},"Sign in"))))}var ue=n(31),se=n(46),me=n(38),de=n(39),fe=function(e){Object(de.a)(n,e);var t=Object(me.a)(n);function n(e){var a;return Object(ue.a)(this,n),(a=t.call(this,e)).state={error:void 0},a}return Object(se.a)(n,[{key:"render",value:function(){return this.state.error?r.a.createElement(F,null,r.a.createElement(ee,{error:this.state.error})):this.props.children}}],[{key:"getDerivedStateFromError",value:function(e){return{error:e.toString()}}}]),n}(r.a.Component);var be=function(){return r.a.createElement(d.a,null,r.a.createElement(o.a,{theme:m},r.a.createElement(i.a,null),r.a.createElement(fe,null,r.a.createElement(f.d,null,r.a.createElement(f.b,{path:"/sessions/:id",component:le}),r.a.createElement(f.b,{path:"/",component:ie})))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(r.a.createElement(be,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},30:function(e,t,n){var a=n(109);n(110),n(113);a.initializeApp({apiKey:"AIzaSyDb3dX8j1yMlbNFGHI9QqRpSBjJ0WsWO4I",authDomain:"tin-tin-5e0d8.firebaseapp.com",databaseURL:"https://tin-tin-5e0d8.firebaseio.com",projectId:"tin-tin-5e0d8",storageBucket:"tin-tin-5e0d8.appspot.com",messagingSenderId:"196227528129",appId:"1:196227528129:web:51ad97056e103f78c2ab40"}),e.exports=a},97:function(e,t,n){e.exports={noselect:"Playing_noselect__28UVJ"}}},[[104,1,2]]]);
//# sourceMappingURL=main.861b6a46.chunk.js.map